;TO_BE_1024KB_MAX
;IS_128_ROWS_OF_CODES

* = $0500
ENIGVA = $50
KEYIN  = $57
KEYOUT = $58 

TIMEO1 = $59
DISP3 = $F9

JMP INIT

DEFVAL
.BYTE $01
.BYTE $02
.BYTE $03
.BYTE $01
.BYTE $02
.BYTE $03
.BYTE $04

STEPS
.BYTE $03
.BYTE $05
.BYTE $07

FWRTR
.BYTE $3
.BYTE $7
.BYTE $4
.BYTE $8
.BYTE $9
.BYTE $2
.BYTE $0
.BYTE $5
.BYTE $1
.BYTE $6
FWRTR2
.BYTE $7
.BYTE $4
.BYTE $0
.BYTE $9
.BYTE $6
.BYTE $1
.BYTE $8
.BYTE $3
.BYTE $2
.BYTE $5
FWRTR3
.BYTE $2
.BYTE $5
.BYTE $8
.BYTE $6
.BYTE $0
.BYTE $3
.BYTE $9
.BYTE $1
.BYTE $4
.BYTE $7
REFLEC
.BYTE $5
.BYTE $3
.BYTE $9
.BYTE $1
.BYTE $7
.BYTE $0
.BYTE $8
.BYTE $4
.BYTE $6
.BYTE $2
BWRTR
.BYTE $6
.BYTE $8
.BYTE $5
.BYTE $0
.BYTE $2
.BYTE $7
.BYTE $9
.BYTE $1
.BYTE $3
.BYTE $4
BWRTR2
.BYTE $2
.BYTE $5
.BYTE $8
.BYTE $7
.BYTE $1
.BYTE $9
.BYTE $4
.BYTE $0
.BYTE $6
.BYTE $3
BWRTR3
.BYTE $4
.BYTE $7
.BYTE $0
.BYTE $5
.BYTE $8
.BYTE $1
.BYTE $3
.BYTE $9
.BYTE $2
.BYTE $6

KEYTBL
.BYTE 10 ;INC_VAL1
.BYTE 0C ;DEV_VAL1
.BYTE 11 ;INC_VAL2
.BYTE 0D ;DEV_VAL1
.BYTE 14 ;INC_VAL3
.BYTE 0E ;DEV_VAL1
.BYTE 12 ;INC_VAL4
.BYTE 0F ;DEV_VAL1

INIT

LDA #$0         ;ROTOR_CONFIG
CMP *ENIGVA
BNE INITOK

LDA #$7
STA *TIMEO1
LDX #$0

CPYINI
LDA DEFVAL,X
STA *ENIGVA,X
INX
DEC *TIMEO1
BNE CPYINI

INITOK

START

JSR TIMEOU

JSR SHOWEN

JSR $1F1F
JSR $1F6A

CMP #$15   
BCS START ;IF_ABOVE_15

CMP #$0C
BCS MENU ;IF_ABOVE_DO_MENU

STA *KEYIN

JSR ENIGMA

LDA #$50
STA *TIMEO1

JMP START

MENU

JMP START

TIMEOU

LDA #$0
CMP *TIMEO1
BEQ NOTOUT
DEC *TIMEO1
BNE NOTOUT

STA *KEYIN
STA *KEYOUT

NOTOUT:

RTS

SHOWEN

LDX #$0
LDY #$3
SHOWND
LDA *$53,X
ASL A
ASL A
ASL A
ASL A
STA $F8,Y
INX
LDA *$53,X
ORA $F8,Y
STA $F8,Y
INX
DEY
BNE SHOWND

RTS

MENU

RTS

ENIGMA
LDA *KEYIN
STA *KEYOUT
INC *KEYOUT

RTS

